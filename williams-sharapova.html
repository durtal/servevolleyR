<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />



<title>Wimbledon 2015</title>

<script src="libs/jquery-1.11.0/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="libs/bootstrap-3.3.1/css/united.min.css" rel="stylesheet" />
<script src="libs/bootstrap-3.3.1/js/bootstrap.min.js"></script>
<script src="libs/bootstrap-3.3.1/shim/html5shiv.min.js"></script>
<script src="libs/bootstrap-3.3.1/shim/respond.min.js"></script>
<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 20px;
  padding-bottom: 20px;
}
@media (max-width: 979px) {
  body {
    padding-top: 0;
  }
}
/* offset scroll position for anchor links (for fixed navbar)  */
@media (min-width: 980px) {
  .section h2 {
    padding-top: 52px;
    margin-top: -52px;
  }
  .section h3 {
    padding-top: 52px;
    margin-top: -52px;
  }
}
p{
  font-size: 13px;
}
/* don't use link color in navbar */
.dropdown-menu>li>a {
  color: black;
}
/* some padding for disqus */
#disqus_thread {
  margin-top: 45px;
}
</style>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; }
code > span.dt { color: #902000; }
code > span.dv { color: #40a070; }
code > span.bn { color: #40a070; }
code > span.fl { color: #40a070; }
code > span.ch { color: #4070a0; }
code > span.st { color: #4070a0; }
code > span.co { color: #60a0b0; font-style: italic; }
code > span.ot { color: #007020; }
code > span.al { color: #ff0000; font-weight: bold; }
code > span.fu { color: #06287e; }
code > span.er { color: #ff0000; font-weight: bold; }
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>



</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img { 
  max-width:100%; 
  height: auto; 
}
</style>
<div class="container-fluid main-container">

<h1>servevolleyR</h1>
<nav class="navbar navbar-inverse">
	<div class="container-fluid">
		<div class="navbar-header">
			<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
				<span class="sr-only">Toggle navigation</span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
			</button>
			<a class="navbar-brand" href="http://durtal.github.io/">durtal.github.io</a>
		</div>

		<div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
			<ul class="nav navbar-nav">
				<li>
					<a href="index.html">Home</a>
				</li>
				<li class="dropdown">
					<a href="Datasets" class="dropdown-toggle" data-toggle="dropdown">
						Functions <b class="caret"></b>
					</a>
					<ul class="dropdown-menu">
						<li class="dropdown-header">Simulation</li>
						<li>
							<a href="simPoint.html">simPoint</a>
						</li>
                        <li>
                        	<a href="simGame.html">simGame</a>
                        </li>
						<li>
							<a href="simTiebreak.html">simTiebreak</a>
						</li>
						<li>
							<a href="simSet.html">simSet</a>
						</li>
						<li>
							<a href="simMatch.html">simMatch</a>
						</li>
						<li class="dropdown-header">Simulation<strong>s</strong></li>
						<li>
							<a href="simGames.html">simGames</a>
						</li>
						<li>
							<a href="simSets.html">simSets</a>
						</li>
						<li>
							<a href="simMatches.html">simMatches</a>
						</li>
						<li class="dropdown-header">Other</li>
						<li>
							<a href="simDf.html">simDf</a>
						</li>
					</ul>
				</li>
				<li class="dropdown">
				    <a href="vignettes" class="dropdown-toggle" data-toggle="dropdown">Vignettes <b class="caret"></b></a>
				    <ul class="dropdown-menu">
				        <li class="dropdown-header">Wimbledon 2015</li>
				        <li>
				            <a href="williams-sharapova.html">Williams vs Sharapova</a>
				        </li>
				        <li>
				            <a href="federer-murray.html">Federer vs Murray</a>
				        </li>
				    </ul>
				</li>
			</ul>
		</div>
	</div>
</nav>

<div id="header">
<h1 class="title">Wimbledon 2015</h1>
</div>


<div id="williams-vs-sharapova" class="section level3">
<h3>Williams vs Sharapova</h3>
<p>Today sees Serena Williams take on Maria Sharapova in the semi-final of Wimbledon 2015. This post will walk through an example use of the package using this match-up.</p>
<p>First make sure the package is installed and loaded:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># devtools::install_github(&quot;durtal/servevolleyR&quot;)</span>
<span class="kw">library</span>(servevolleyR)</code></pre>
<p>What <code>servevolleyR</code> requires is a probability that a player will win the point on their first serve. For this quick example, we’ll use the players performance in their last matches. Williams defeated her sister, Venus, in two sets, with some summary statistics shown in the picture below left, while Sharapova beat Vandeweghe in three sets, with some summary statistics shown in the picture below right.</p>
<div class="row">
<div class="col-sm-6">
<p><img src="serena.jpg" style="align:center" class="img-responsive"></p>
</div>
<div class="col-sm-6">
<p><img src="maria.jpg" style="align:center" class="img-responsive"></p>
</div>
</div>
<p>The stats show that Serena won 80% of points on her first serve, while Sharapova won 73%. These two numbers, while very simple can be used to simulate a game, set, tiebreak, and match between the two. However additional parameters can also be provided, namely, the probability that a player will win a point on their second serve, and the probability that the players first serve will be in. These can also be seen in the pictures above. So for the two players (Maria’s second serve was woeful!):</p>
<pre class="sourceCode r"><code class="sourceCode r">williams1 &lt;-<span class="st"> </span><span class="fl">0.80</span>     <span class="co"># serena first serve win %</span>
williams2 &lt;-<span class="st"> </span><span class="fl">0.58</span>     <span class="co"># serena second serve win %</span>
williamsIn &lt;-<span class="st"> </span><span class="fl">0.65</span>    <span class="co"># serena first serve in %</span>

sharapova1 &lt;-<span class="st"> </span><span class="fl">0.73</span>      <span class="co"># maria first serve win %</span>
sharapova2 &lt;-<span class="st"> </span><span class="fl">0.36</span>      <span class="co"># maria second serve win %</span>
sharapovaIn &lt;-<span class="st"> </span><span class="fl">0.6</span>      <span class="co"># maria first serve in %</span></code></pre>
<p>We can then use these parameters in the following functions included in <code>servevolleyR</code>, <a href="simGame.html"><code>simGame</code></a>, <a href="simGames.html"><code>simGames</code></a>, <a href="simSet.html"><code>simSet</code></a>, <a href="simSets.html"><code>simSets</code></a>, <a href="simTiebreak.html"><code>simTiebreak</code></a>, <a href="simMatch.html"><code>simMatch</code></a> and <a href="simMatches.html"><code>simMatches</code></a>.</p>
</div>
<div id="simgame-and-simgames" class="section level3">
<h3><code>simGame</code> and <code>simGames</code></h3>
<p><code>simGame</code> simulates a single service game given a number of parameters, the only one required is the probability that a player wins a point on their first serve, <code>williams1</code> and <code>sharapova1</code> above, but additional parameters can also be provided. To simulate many service games, there are two options, the first, probably quicker is to use <code>simGame</code> inside <code>replicate</code>, we’ll look at Serena for this example, the second is to use <code>simGames</code>.</p>
<div id="williams-service-games" class="section level4">
<h4>Williams service games</h4>
<p>Using <code>simGame</code> and <code>replicate</code></p>
<pre class="sourceCode r"><code class="sourceCode r">williamsServe &lt;-<span class="st"> </span><span class="kw">replicate</span>(<span class="fl">1e3</span>, <span class="kw">simGame</span>(<span class="dt">p =</span> williams1,
                                      <span class="dt">p2 =</span> williams2,
                                      <span class="dt">firstServe =</span> williamsIn))</code></pre>
<p><code>williamsServe</code> is a vector of 1000 service game results, <strong>1</strong> when the server (Serena) wins, and <strong>0</strong> when the returner wins, the first 6 results are 1, 1, 1, 1, 1, 1. This vector can be summarised as follows.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">table</span>(williamsServe) /<span class="st"> </span><span class="kw">sum</span>(<span class="kw">table</span>(williamsServe))</code></pre>
<pre><code>## williamsServe
##     0     1 
## 0.078 0.922</code></pre>
<p>The simulation estimates that Serena will win 0.922 of her service games.</p>
</div>
<div id="sharapova-service-games" class="section level4">
<h4>Sharapova service games</h4>
<p>Using <code>simGames</code></p>
<pre class="sourceCode r"><code class="sourceCode r">sharapovaServe &lt;-<span class="st"> </span><span class="kw">simGames</span>(<span class="dt">n =</span> <span class="fl">1e3</span>,                <span class="co"># number of simulations</span>
                       <span class="dt">p =</span> sharapova1,
                       <span class="dt">p2 =</span> sharapova2,
                       <span class="dt">firstServe =</span> sharapovaIn)</code></pre>
<div class="row">
<div class="col-sm-6">
<p>The benefit of using <code>simGames</code> isn’t speed, but detail, <code>simGames</code> returns a list with detailed data about the simulated games, data that includes the number of points each player won in a service game. The list has a class of <strong>svR_games</strong>, which comes with a few methods, such as <code>print</code>, <code>summary</code> and <code>plot</code>, the print method is shown below. While the plot method can be seen to the right, it shows the probability that Maria will win her service game (0.7), as well as the scores in the service games, 0 corresponds to <em>love</em>, 1 to 15, so the score 4-2 is W-30, 5-3 is winning after deuce:</p>
<pre class="sourceCode r"><code class="sourceCode r">sharapovaServe</code></pre>
<pre><code>## 
## Simulation of 1000 service games:
## Server won 0.7 (700/1000) of games.
## 
## Server probabilities:
##     p   p2 firstServe
##  0.73 0.36        0.6</code></pre>
</div>
<div class="col-sm-6">
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(sharapovaServe)</code></pre>
<p><img src="williams-sharapova_files/figure-html/unnamed-chunk-7-1.png" title="" alt="" width="672" style="display: block; margin: auto;" /></p>
</div>
</div>
</div>
</div>
<div id="simset-and-simsets" class="section level3">
<h3><code>simSet</code> and <code>simSets</code></h3>
<p><code>simSet</code> simulates a single set given a number of parameters for two players, the only two required is the probability that each player wins a point on their first serve, <code>williams1</code> and <code>sharapova1</code> above, but additional parameters can also be provided. To simulate many service games, there are two options, the first, probably quicker is to use <code>simSet</code> inside <code>replicate</code>, we’ll just use <code>simSets</code>.</p>
<p>Another thing worth bearing in mind is that player A opens the serving.</p>
<pre class="sourceCode r"><code class="sourceCode r">williamsSets &lt;-<span class="st"> </span><span class="kw">simSets</span>(<span class="dt">n =</span> <span class="fl">1e3</span>, <span class="dt">playTiebreak =</span> <span class="ot">TRUE</span>, <span class="dt">players =</span> <span class="kw">c</span>(<span class="st">&quot;Serena&quot;</span>, <span class="st">&quot;Maria&quot;</span>),
                      <span class="dt">pA =</span> williams1, <span class="dt">p2A =</span> williams2, <span class="dt">firstServeA =</span> williamsIn,
                      <span class="dt">pB =</span> sharapova1, <span class="dt">p2B =</span> sharapova2, <span class="dt">firstServeB =</span> sharapovaIn)</code></pre>
<div class="row">
<div class="col-sm-6">
<p>Like <code>simGames</code>, it is likely slower than using <code>replicate</code> and <code>simSet</code>, however the list returned by <code>simSets</code> has much more detail about the simulated Sets. The list has a class of <strong>svR_sets</strong>, which comes with a few methods, such as <code>print</code>, <code>summary</code>, and <code>plot</code>. The summary method is shown below. While the plot method is shown to the right, showing the probability that player A will win the set (0.87), as well as the probability for each potential set score:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(williamsSets)</code></pre>
<pre><code>## 
## Simulation of 1000 sets:
## 
## Server Probabilities:
##  player    p   p2 firstServe
##  Serena 0.80 0.58       0.65
##   Maria 0.73 0.36       0.60
## 
## Player A (Serena) won 0.87 of sets.
##        playerB
## playerA     0     1     2     3     4     5     6     7
##       2                                     0.002      
##       3                                     0.008      
##       4                                     0.072      
##       5                                           0.009
##       6 0.024 0.143 0.110 0.321 0.091             0.039
##       7                               0.077 0.104</code></pre>
</div>
<div class="col-sm-6">
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(williamsSets)</code></pre>
<p><img src="williams-sharapova_files/figure-html/unnamed-chunk-10-1.png" title="" alt="" width="672" style="display: block; margin: auto;" /></p>
</div>
</div>
<p>The list returned by <code>simSets</code> can be converted into a dataframe for further analysis, this dataframe effectively contains data about simulated service games, thereby not requiring the use of <code>simGames</code>. To convert this to a dataframe simply use the <a href="simDf.html"><code>simDf</code></a> function, it can sometimes take some time to convert the data, the larger the number of simulations the longer it takes:</p>
<pre class="sourceCode r"><code class="sourceCode r">williamsSetsDf &lt;-<span class="st"> </span><span class="kw">simDf</span>(williamsSets)
<span class="kw">head</span>(williamsSetsDf)</code></pre>
<pre><code>##   simNo     pA    pB setA setB set_res gameNo serving    p   p2 firstServe
## 1     1 Serena Maria    6    4       1      1  Serena 0.80 0.58       0.65
## 2     1 Serena Maria    6    4       1      2   Maria 0.73 0.36       0.60
## 3     1 Serena Maria    6    4       1      3  Serena 0.80 0.58       0.65
## 4     1 Serena Maria    6    4       1      4   Maria 0.73 0.36       0.60
## 5     1 Serena Maria    6    4       1      5  Serena 0.80 0.58       0.65
## 6     1 Serena Maria    6    4       1      6   Maria 0.73 0.36       0.60
##   game_res server returner
## 1        1      4        1
## 2        1      7        5
## 3        1      4        1
## 4        1      5        3
## 5        1      4        1
## 6        1      4        2</code></pre>
</div>
<div id="simmatch-and-simmatches" class="section level3">
<h3><code>simMatch</code> and <code>simMatches</code></h3>
<p>These two functions follow the same convention as those above, and require parameters for two players, and a few details about the type of match they are playing, ie. how many sets, play tiebreaks, etc.</p>
<p>I’ll just use <code>simMatches</code> here, with Serena opening the serving.</p>
<pre class="sourceCode r"><code class="sourceCode r">williamsMatch &lt;-<span class="st"> </span><span class="kw">simMatches</span>(<span class="dt">n =</span> <span class="fl">1e3</span>, <span class="dt">sets =</span> <span class="dv">3</span>, <span class="dt">finalSetTiebreak =</span> <span class="ot">TRUE</span>,
                          <span class="dt">players =</span> <span class="kw">c</span>(<span class="st">&quot;Serena&quot;</span>, <span class="st">&quot;Maria&quot;</span>), <span class="dt">tiebreaks =</span> <span class="ot">TRUE</span>,
                          <span class="dt">pA =</span> williams1, <span class="dt">p2A =</span> williams2, <span class="dt">firstServeA =</span> williamsIn,
                          <span class="dt">pB =</span> sharapova1, <span class="dt">p2B =</span> sharapova2, <span class="dt">firstServeB =</span> sharapovaIn)</code></pre>
<div class="row">
<div class="col-sm-6">
<p>Like the previous two functions, <code>simGames</code> and <code>simSets</code>, it is likely slower than using <code>replicate</code> and <code>simMatch</code>, but the detail is much better, getting data about the matches, sets, and games in each simulation. The list returned has a class of <strong>svR_matches</strong>, which comes with <code>print</code>, <code>summary</code>, and <code>plot</code> methods. The summary method is shown below, while the plot to the right shows the probability of Player A winning the match (0.949), as well as the final scores.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(williamsMatch)</code></pre>
<pre><code>## 
## Simulation of 1000 matches:
## 
## Player A (Serena) won 0.949 of matches.
## 
## Server Probabilities:
##  player    p   p2 firstServe
##  Serena 0.80 0.58       0.65
##   Maria 0.73 0.36       0.60
## 
## 
##        playerB
## playerA     0     1     2
##       0             0.021
##       1             0.030
##       2 0.758 0.191</code></pre>
</div>
<div class="col-sm-6">
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(williamsMatch)</code></pre>
<p><img src="williams-sharapova_files/figure-html/unnamed-chunk-14-1.png" title="" alt="" width="672" style="display: block; margin: auto;" /></p>
</div>
</div>
<div class="row">
<div class="col-sm-6">
<p>Sharapova’s second serve % will need to be much improved if she is to get close to Serena. Simulating a match between the two using just their first serves makes the match much closer:</p>
<pre class="sourceCode r"><code class="sourceCode r">FirstServes &lt;-<span class="st"> </span><span class="kw">simMatches</span>(<span class="dt">n =</span> <span class="fl">1e3</span>, <span class="dt">sets =</span> <span class="dv">3</span>, <span class="dt">finalSetTiebreak =</span> <span class="ot">TRUE</span>,
                          <span class="dt">players =</span> <span class="kw">c</span>(<span class="st">&quot;Serena&quot;</span>, <span class="st">&quot;Maria&quot;</span>), <span class="dt">tiebreaks =</span> <span class="ot">TRUE</span>,
                          <span class="dt">pA =</span> williams1, <span class="dt">pB =</span> sharapova1)</code></pre>
</div>
<div class="col-sm-6">
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(FirstServes)</code></pre>
<p><img src="williams-sharapova_files/figure-html/unnamed-chunk-16-1.png" title="" alt="" width="672" style="display: block; margin: auto;" /></p>
</div>
</div>
<p>This list can also be converted to a dataframe for further analysis using the <a href="simDf.html"><code>simDf</code></a> function.</p>
</div>


</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});

</script>


</body>
</html>
